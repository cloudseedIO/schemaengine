[{"controllers": {"compact": "/pools/default/buckets/messages/ddocs/_design%2Fdev_notifications/controller/compactView", "setUpdateMinChanges": "/pools/default/buckets/messages/ddocs/_design%2Fdev_notifications/controller/setUpdateMinChanges"}, "doc": {"json": {"views": {"noResponseTopics": {"map": "function(doc,meta){\n\tif(doc.type==\"Topic\" && Array.isArray(doc.contacted)){\n\t\tvar flag=true;\n\t\tfor(var i=0;i<doc.contacted.length;i++){\n                  \t\n\t\t\tif(doc.contacted[i].status!=\"pending\"){\n\t\t\t\tflag=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(flag){\n\t\t\tvar value={\n\t\t\t     type:doc.type,\n\t\t\t     userId:doc.userId,\n\t\t\t     message:doc.message,\n\t\t\t     status:doc.status,\n\t\t\t     topic:doc.topic,\n\t\t\t     createdDate:doc.createdDate,\n\t\t\t     contacted:doc.contacted,\n\t\t\t     counter:doc.counter,\n\t\t\t     id:doc.id\n\t\t\t};\n\t\t\temit([doc.userId],value);\n\t\t}\n\t}\n}\n\n", "reduce": "_count"}, "allPendingChats": {"map": "function(doc,meta){\n\tif(doc.type==\"PersonalChat\"){\n\t\t var value={\n\t\t\t     chatFrom:doc.chatFrom,\n\t\t\t     chatTo:doc.chatTo,\n\t\t\t     counter:doc.counter,\n\t\t\t     createdDate:doc.createdDate,\n\t\t\t     org:doc.org,\n\t\t\t     status:doc.status,\n\t\t\t     topic:doc.topic,\n\t\t\t     topicId:doc.topicId,\n\t\t\t     type:doc.type,\n\t\t\t     id:doc.id,\n\t\t\t     updatedDate:doc.updatedDate\n\t\t\t   };\n\t\tfor(var key in doc.status){\n\t\t\tif(doc.counter[key].count>0 && doc.status[key].type==\"active\"){\n\t\t\t\temit([key],value)\n\t\t\t}\n\t\t}\n\t}\n}", "reduce": "_count"}, "allPendingTopicsByUser": {"map": "function(doc,meta){\n\tif(doc.type==\"Topic\" && Array.isArray(doc.contacted)){\n\t\tvar value={\n\t\t     type:doc.type,\n\t\t     userId:doc.userId,\n\t\t     message:doc.message,\n\t\t     status:doc.status,\n\t\t     topic:doc.topic,\n\t\t     createdDate:doc.createdDate,\n\t\t     contacted:doc.contacted,\n\t\t     counter:doc.counter,\n\t\t     id:doc.id\n\t\t   };\n\t\tfor(var i=0;i<doc.contacted.length;i++){\n\t\t\tif(doc.contacted[i].status==\"pending\"){\n\t\t\t\temit([doc.contacted[i].userId,doc.contacted[i].org],value);\n\t\t\t}\n\t\t}\n\t}\n}", "reduce": "_count"}, "countByUserId": {"map": "function (doc, meta) {\n  for( var key in doc.counter){\n    if(doc.counter[key].count>0 && doc.status[key].type!=\"deleted\")\n    emit(key, doc.counter[key].count);\n  }\n}", "reduce": "_sum"}, "myTopicsAndChats": {"map": "function (doc, meta) {\n if(doc.type==\"Topic\" && Array.isArray(doc.contacted)){\n   var value={\n     type:doc.type,\n     userId:doc.userId,\n     message:doc.message,\n     status:doc.status,\n     topic:doc.topic,\n     createdDate:doc.createdDate,\n     contacted:doc.contacted,\n     counter:doc.counter,\n     id:doc.id\n   };\n   for(var i=0;i<doc.contacted.length;i++){\n    var contacted=doc.contacted[i];\n    if(doc.status[contacted.userId].type==\"pending\" || doc.status[contacted.userId].type==\"active\")\n    emit([contacted.userId,doc.updatedDate],value);\n  }\n }else if(doc.type==\"PersonalChat\"){\n   var value={\n     chatFrom:doc.chatFrom,\n     chatTo:doc.chatTo,\n     counter:doc.counter,\n     createdDate:doc.createdDate,\n     org:doc.org,\n     status:doc.status,\n     topic:doc.topic,\n     topicId:doc.topicId,\n     type:doc.type,\n     id:doc.id,\n     updatedDate:doc.updatedDate\n   };\n   if(typeof doc.status==\"object\" && doc.status!=null){\n     for(var key in doc.status){\n       if(doc.status[key].type==\"active\"){\n         emit([key,doc.updatedDate],value);\n       }\n     }\n   }\n }\n}"}}}, "meta": {"rev": "1-d3a6c9b8", "id": "_design/dev_notifications"}}}, {"controllers": {"compact": "/pools/default/buckets/messages/ddocs/_design%2Fnotifications/controller/compactView", "setUpdateMinChanges": "/pools/default/buckets/messages/ddocs/_design%2Fnotifications/controller/setUpdateMinChanges"}, "doc": {"json": {"views": {"noResponseTopics": {"map": "function(doc,meta){\n\tif(doc.type==\"Topic\" && Array.isArray(doc.contacted)){\n\t\tvar flag=true;\n\t\tfor(var i=0;i<doc.contacted.length;i++){\n                  \t\n\t\t\tif(doc.contacted[i].status!=\"pending\"){\n\t\t\t\tflag=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(flag){\n\t\t\tvar value={\n\t\t\t     type:doc.type,\n\t\t\t     userId:doc.userId,\n\t\t\t     message:doc.message,\n\t\t\t     status:doc.status,\n\t\t\t     topic:doc.topic,\n\t\t\t     createdDate:doc.createdDate,\n\t\t\t     contacted:doc.contacted,\n\t\t\t     counter:doc.counter,\n\t\t\t     id:doc.id\n\t\t\t};\n\t\t\temit([doc.userId],value);\n\t\t}\n\t}\n}\n\n", "reduce": "_count"}, "allPendingChats": {"map": "function(doc,meta){\n\tif(doc.type==\"PersonalChat\"){\n\t\t var value={\n\t\t\t     chatFrom:doc.chatFrom,\n\t\t\t     chatTo:doc.chatTo,\n\t\t\t     counter:doc.counter,\n\t\t\t     createdDate:doc.createdDate,\n\t\t\t     org:doc.org,\n\t\t\t     status:doc.status,\n\t\t\t     topic:doc.topic,\n\t\t\t     topicId:doc.topicId,\n\t\t\t     type:doc.type,\n\t\t\t     id:doc.id,\n\t\t\t     updatedDate:doc.updatedDate\n\t\t\t   };\n\t\tfor(var key in doc.status){\n\t\t\tif(doc.counter[key].count>0 && doc.status[key].type==\"active\"){\n\t\t\t\temit([key],value)\n\t\t\t}\n\t\t}\n\t}\n}", "reduce": "_count"}, "allPendingTopicsByUser": {"map": "function(doc,meta){\n\tif(doc.type==\"Topic\" && Array.isArray(doc.contacted)){\n\t\tvar value={\n\t\t     type:doc.type,\n\t\t     userId:doc.userId,\n\t\t     message:doc.message,\n\t\t     status:doc.status,\n\t\t     topic:doc.topic,\n\t\t     createdDate:doc.createdDate,\n\t\t     contacted:doc.contacted,\n\t\t     counter:doc.counter,\n\t\t     id:doc.id\n\t\t   };\n\t\tfor(var i=0;i<doc.contacted.length;i++){\n\t\t\tif(doc.contacted[i].status==\"pending\"){\n\t\t\t\temit([doc.contacted[i].userId,doc.contacted[i].org],value);\n\t\t\t}\n\t\t}\n\t}\n}", "reduce": "_count"}, "countByUserId": {"map": "function (doc, meta) {\n  for( var key in doc.counter){\n    if(doc.counter[key].count>0 && doc.status[key].type!=\"deleted\")\n    emit(key, doc.counter[key].count);\n  }\n}", "reduce": "_sum"}, "myTopicsAndChats": {"map": "function (doc, meta) {\n if(doc.type==\"Topic\" && Array.isArray(doc.contacted)){\n   var value={\n     type:doc.type,\n     userId:doc.userId,\n     message:doc.message,\n     status:doc.status,\n     topic:doc.topic,\n     createdDate:doc.createdDate,\n     contacted:doc.contacted,\n     counter:doc.counter,\n     id:doc.id\n   };\n   for(var i=0;i<doc.contacted.length;i++){\n    var contacted=doc.contacted[i];\n    if(doc.status[contacted.userId].type==\"pending\" || doc.status[contacted.userId].type==\"active\")\n    emit([contacted.userId,doc.updatedDate],value);\n  }\n }else if(doc.type==\"PersonalChat\"){\n   var value={\n     chatFrom:doc.chatFrom,\n     chatTo:doc.chatTo,\n     counter:doc.counter,\n     createdDate:doc.createdDate,\n     org:doc.org,\n     status:doc.status,\n     topic:doc.topic,\n     topicId:doc.topicId,\n     type:doc.type,\n     id:doc.id,\n     updatedDate:doc.updatedDate\n   };\n   if(typeof doc.status==\"object\" && doc.status!=null){\n     for(var key in doc.status){\n       if(doc.status[key].type==\"active\"){\n         emit([key,doc.updatedDate],value);\n       }\n     }\n   }\n }\n}"}}}, "meta": {"rev": "1-e01c79cc", "id": "_design/notifications"}}}]